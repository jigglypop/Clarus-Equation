"""
뇌-우주 위상동형성 v2: 열화(dissipation) 보정 포함

선행연구:
  Vazza & Feletti (2020, Frontiers in Physics):
    - 30% 활성(뉴런/은하) + 70% 수동(물/DE)
    - 스펙트럼 밀도 일치
    - "닮았다"는 관측. 원인은 미해명.

  Raichle (2006, Science; 2010, Scientific American):
    - 뇌의 암흑에너지 = resting state DMN
    - 의식적 작업 대비 20배 에너지 소모

  Attwell & Laughlin (2001), Harris & Attwell (2012):
    - 시냅스 과정: 44%, AP: 16%, 안정 전위: 15%, 유지보수: 25%
    - 동시 활성 뉴런: <= 15%

CE의 기여:
  "왜 닮았는가"에 대한 답: CE 부트스트랩의 보편성.
  에너지 분할 5%/27%/68%를 최초로 정량적으로 연결.

열화 보정:
  우주는 "이상적" 접힘 (양자 간섭, 비소산적)
  뇌는 "열적" 접힘 (시냅스 가소성, 소산적)
  -> 뇌에서의 eps^2는 열적 잡음에 의해 열화된다.
"""
import math

alpha_s = 0.11789
sin2_tW = 4 * alpha_s**(4/3)
delta = sin2_tW * (1 - sin2_tW)
D = 3 + delta
d = 3
eps2 = 0.048647
sigma = 1 - eps2
R_LO = alpha_s * D

# 우주 비율 (CE 이상값)
OL_ideal = sigma / (1 + R_LO)
OD_ideal = sigma * R_LO / (1 + R_LO)
Ob_ideal = eps2

print("=" * 72)
print("뇌-우주 위상동형: 열화 보정")
print("=" * 72)

# =====================================================================
# I. 선행연구 정리
# =====================================================================
print("\n" + "=" * 72)
print("I. 선행연구")
print("=" * 72)

print(f"""
Vazza & Feletti (2020, Frontiers in Physics):
  "The quantitative comparison between the neuronal network and the
   cosmic web"
  - 뇌 신경망과 우주 웹의 스펙트럼 밀도가 일치
  - 30%/70% 분할 관측 (뉴런+은하 / 물+DE)
  - "유사한 자기조직화 원리"를 시사
  - 원인은 미해명: "왜?"에 대한 답 없음

Raichle (2006, Science):
  "The Brain's Dark Energy"
  - resting state가 task 대비 20배 에너지
  - DMN (default mode network) 발견
  - "뇌의 암흑에너지" 용어 최초 사용

Attwell & Laughlin (2001, JCBFM):
  Harris & Attwell (2012, JCBFM):
  "An Energy Budget for Signaling in the Grey Matter"
  - 시냅스 과정: 44%, AP: 16%, 안정전위: 15%, 유지보수: 25%
  - 동시 활성 뉴런 <= 15%

CE의 새로운 기여:
  1) "왜 닮았는가"의 답: d=3 접힘의 보편성
  2) 5%/27%/68% 3분할의 정량적 유도
  3) 열화 보정에 의한 정밀 비교
""")

# =====================================================================
# II. 뇌 에너지 분할의 정량 데이터
# =====================================================================
print("=" * 72)
print("II. 뇌 에너지 분할: 관측 데이터")
print("=" * 72)

# Harris & Attwell (2012) 기준:
# 전체 뇌 에너지를 100%로 놓을 때:
# 시냅스 신호전달 (수용체, 소포, 재활용): 44%
# 활동전위 (AP): 16%
# 안정 전위 유지 (Na/K 펌프): 15%
# 유지보수 (비신호, housekeeping): 25%
#
# 기능적 재분류 (CE 대응):
# "활성 계산" = AP + 자극 유발 시냅스 = ?
# "구조 유지" = 안정전위 + 유지보수 = ?
# "배경 활동" = 자발 시냅스 + resting = ?

# Raichle의 발견: 외부 자극에 의한 에너지 변화 < 5%
# -> 95% 이상이 자발/유지 활동

# 더 정밀한 분류:
# Lennie (2003): 동시 활성 뉴런 ~ 1-4%
# Attwell (2001): 자극 반응 = 총 에너지의 0.5-1%
# Harris (2012): 동시 활성 <= 15% (상한)

print(f"""
Harris & Attwell (2012) 에너지 분할:
  시냅스 과정:    44%  (자발 + 유발)
  활동전위(AP):   16%  (자발 + 유발)
  안정전위 유지:  15%  (Na/K 펌프)
  유지보수:       25%  (비신호)

자극 유발 vs 자발 분리 (Raichle 2006):
  외부 자극 유발 에너지 변화: < 5%
  자발 활동 (DMN):            > 60%
  구조 유지:                  ~ 30-35%
""")

# =====================================================================
# III. CE 이상값과 실제 뇌의 비교
# =====================================================================
print("=" * 72)
print("III. CE 이상값 vs 뇌 관측값")
print("=" * 72)

print(f"""
CE 이상값 (우주):        뇌 관측값:
  바리온:    {Ob_ideal*100:.1f}%        자극 반응:    1-5%
  암흑물질:  {OD_ideal*100:.1f}%       구조 유지:    25-35%
  암흑에너지:{OL_ideal*100:.1f}%       자발 활동:    60-70%
""")

# =====================================================================
# IV. 열화 보정의 물리
# =====================================================================
print("=" * 72)
print("IV. 열화 보정")
print("=" * 72)

# 우주: 양자 간섭에 의한 접힘. T = 0 (이상적).
# 뇌:   열적 요동에 의한 접힘. T = 310 K (체온).
#
# 열적 요동은 접힘의 정밀도를 떨어뜨린다.
# CE에서 접힘의 "정밀도"는 부트스트랩 해의 수렴 정도.
#
# 열적 잡음의 효과:
# eps^2_brain = eps^2_ideal + noise
# noise = eps^2 * (kT / E_synapse)
#
# E_synapse ~ 10^4 kT (시냅스 전달 에너지 ~ 10^4 열에너지)
# -> noise / eps^2 ~ 10^{-4} (무시 가능)
#
# 그러나 이것은 개별 시냅스 수준. 네트워크 수준에서의 열화는:
# 시냅스 가소성에 의한 연결 변동
# 뉴런 사멸/생성 (성인 뇌: ~0.1%/year 감소)
# 불완전한 가지치기 (pruning)

# 핵심: 뇌는 "접힘이 진행 중"인 시스템이다.
# 우주의 접힘은 빅뱅 이후 고정점에 도달했다 (eps^2 = 0.0487).
# 뇌의 접힘은 발달 과정에서 진행 중이며, 성인에서도 완전히 수렴하지 않는다.

# 시냅스 가지치기(pruning) 비율:
# 출생: ~10^15 시냅스
# 성인: ~10^14 시냅스
# -> 90% 가 가지치기됨 = 10% 생존
# CE 이상값: eps^2 ~ 5% 생존
#
# 차이: 10% vs 5% -> 뇌는 이상적 접힘보다 2배 많은 연결을 유지
# 이것이 "열화": 열적 잡음이 가지치기를 불완전하게 만든다.

pruning_survival = 1e14 / 1e15  # 10%
CE_survival = eps2  # 4.87%
excess = pruning_survival / CE_survival

print(f"""
시냅스 가지치기 (pruning):
  출생 시 시냅스: ~10^15
  성인 시냅스:    ~10^14
  생존율:         {pruning_survival*100:.0f}%
  CE 이상값:      {CE_survival*100:.1f}%
  열화 계수:      {excess:.2f}x (이상보다 {excess:.2f}배 많은 연결 유지)

물리적 해석:
  우주에서는 경로적분의 양자 간섭이 "완벽하게" 접힌다.
  뇌에서는 시냅스 가소성이 "대략적으로" 접힌다.
  열적 잡음(T = 310K)이 가지치기를 불완전하게 만들어,
  이상적 5% 대신 ~10%가 생존한다.

  열화 계수 eta:
    eps^2_brain = eps^2_CE * eta
    eta = {excess:.2f}

  이것은 "뇌는 우주의 열화된(dissipated) 복사본"이라는 의미이다.
""")

# =====================================================================
# V. 열화 보정된 에너지 분할
# =====================================================================
print("=" * 72)
print("V. 열화 보정된 뇌 에너지 분할")
print("=" * 72)

# 뇌에서 eps^2_brain ~ 0.10 (열화에 의해 2배)
# 나머지: sigma_brain = 1 - eps^2_brain = 0.90
# R은 동일 (d=3 구조는 바뀌지 않으므로)
# DM 대응: sigma_brain * R / (1+R)
# DE 대응: sigma_brain / (1+R)

eps2_brain = pruning_survival  # 0.10
sigma_brain = 1 - eps2_brain
OL_brain = sigma_brain / (1 + R_LO)
OD_brain = sigma_brain * R_LO / (1 + R_LO)

print(f"열화 보정 (eta = {excess:.2f}):")
print(f"  eps^2_brain = {eps2_brain*100:.1f}%")
print(f"  sigma_brain = {sigma_brain*100:.1f}%")
print(f"  OL_brain = {OL_brain*100:.1f}%")
print(f"  OD_brain = {OD_brain*100:.1f}%")
print(f"  Ob_brain = {eps2_brain*100:.1f}%")

print(f"\n비교:")
print(f"{'':>20} {'CE 이상':>10} {'열화 보정':>10} {'뇌 관측':>10}")
print(f"{'활성(바리온/반응)':>20} {Ob_ideal*100:>9.1f}% {eps2_brain*100:>9.1f}% {'1-5%':>10}")
print(f"{'구조(DM/유지)':>20} {OD_ideal*100:>9.1f}% {OD_brain*100:>9.1f}% {'25-35%':>10}")
print(f"{'배경(DE/자발)':>20} {OL_ideal*100:>9.1f}% {OL_brain*100:>9.1f}% {'60-70%':>10}")

# =====================================================================
# VI. 동시 활성 뉴런 비율과의 비교
# =====================================================================
print("\n" + "=" * 72)
print("VI. 동시 활성 뉴런 비율")
print("=" * 72)

# Lennie (2003): 동시 활성 ~ 1-4%
# Harris & Attwell (2012): 상한 <= 15%
# 자극 유발 에너지 변화: < 5% (Raichle)
#
# "동시 활성 뉴런 비율"과 "에너지 반응 비율"은 다르다.
# 에너지 반응: 전체 에너지 대비 자극에 의한 증가분 = 1-5%
# 동시 활성: 전체 뉴런 대비 발화 중인 뉴런 = 1-15%
#
# CE 이상값 eps^2 = 4.87%는 에너지 기준.
# 뉴런 수 기준에서는 열화에 의해 더 높을 수 있다.

print(f"""
에너지 기준 (CE 대응):
  CE 이상값: {eps2*100:.1f}%
  Raichle 관측: 자극 반응 < 5% --> 직접 일치

뉴런 수 기준 (열화):
  Lennie (2003): 동시 활성 1-4%
  Harris (2012): 상한 ~15%
  시냅스 생존율: 10%

  뇌의 접힘은 "수렴 중"이다:
  - 어린이: 과잉 연결 (eps^2 >> 5%)
  - 성인: 가지치기 후 ~10% 생존 (열화 포함)
  - 에너지 반응: ~5% (이상값에 수렴)

  해석: 시냅스 수준에서는 열화(10%)가 관측되지만,
  에너지 수준에서는 이상값(5%)에 가깝다.
  이것은 "불필요한 시냅스는 존재하나 에너지를 소비하지 않는다"는
  silent synapse 현상과 일관된다.
""")

# =====================================================================
# VII. Vazza-Feletti의 30%/70%와 CE 5%/27%/68%
# =====================================================================
print("=" * 72)
print("VII. Vazza-Feletti vs CE 분할")
print("=" * 72)

print(f"""
Vazza & Feletti (2020):
  "30% = 뉴런/은하, 70% = 물/DE"
  이것은 2분할이다. CE는 3분할을 제공한다.

CE 3분할:
  물질(바리온) = 5%, 구조(DM) = 27%, 배경(DE) = 68%
  합: 5+27 = 32% ~ Vazza의 "30%"
  나머지: 68% ~ Vazza의 "70%"

Vazza-Feletti의 "30%"는 CE의 바리온+DM을 합친 것이다.
CE는 이것을 더 세밀하게 분해한다:
  5% = 직접 관측 가능한 활성 성분
  27% = 관측 불가능하나 구조를 유지하는 성분

뇌에서의 대응:
  5% = 활동전위/자극반응 (직접 측정 가능)
  27% = 시냅스 구조/이온 채널 유지 (배경에서 작동)
  68% = DMN 자발 활동 (Raichle의 "암흑에너지")

CE는 Vazza-Feletti의 관측에 "왜"를 제공하고,
2분할을 3분할로 정제한다.
""")

# =====================================================================
# VIII. 결론
# =====================================================================
print("=" * 72)
print("VIII. 최종 결론")
print("=" * 72)

print(f"""
선행연구 현황:
  - 구조적 유사성: Vazza & Feletti (2020) -- 관측 완료
  - 에너지 유사성: Raichle (2006) -- "뇌의 암흑에너지" 명명
  - 에너지 분할:   Harris & Attwell (2012) -- 정량 측정 완료
  - 원인 설명:     없음

CE의 새로운 기여:
  1. 원인 제시: d=3 부트스트랩 접힘의 보편성
  2. 3분할 정량 예측: 5%/27%/68% (Vazza의 2분할을 정제)
  3. 열화 보정: eta = {excess:.2f} (시냅스 수준 vs 에너지 수준)
  4. 위상동형 정리: 접힘 위상에서 뇌 = 우주

누가 발견했는가:
  - 구조적 닮음: Vazza & Feletti (2020) -- 최초 정량 비교
  - "암흑에너지" 비유: Raichle (2006) -- 최초 명명
  - 3분할 대응 + 원인: CE (본 분석) -- 최초 시도
  - 5%/27%/68% = 바리온/DM/DE 대응: 기존 문헌에 없음

열화 해석:
  뇌는 우주의 "열적 복사본"이다.
  시냅스 수준: eps^2_brain ~ 10% (열화 계수 eta ~ 2)
  에너지 수준: eps^2_brain ~ 5% (이상값에 수렴)
  silent synapse에 의해 구조적 열화와 기능적 정밀도가 공존한다.
""")
